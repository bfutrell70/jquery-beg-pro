<!DOCTYPE html>
<html>

<head>
    <title>jQuery AJAX getting web APIs</title>
</head>

<body>
    <h1>jQuery AJAX APIs</h1>
    <label for="search">Enter Search text</label>
    <input type="text" placeholder="Search..." name="search" id="txtSearch">
    <input type="button" value="search" id="searchButton">
    <div class="buttonOptions">
        <input type="button" value="Previous" class="tokenClass">
        <input type="button" value="Next"  class="tokenClass">
    </div>
    <br>
    <div id="output">

    </div>
    <script src="../node_modules/jquery/dist/jquery.js"></script>
    <script>
        var pageToken = {};
        
        $(document).ready(function() {
            // hide previous/next buttons until we search
            $('.buttonOptions').hide();

            $('#searchButton').click(searchYoutube);
            // $('#searchButton2').click(searchWSP);

            $('.tokenClass').click(function() {
                console.log($(this).val());
                
                pageToken.current=$(this).val() == "Next" ? pageToken.nextPage : pageToken.prevPage;
                searchYoutube();
            });
        })

        function searchYoutube() {
            var url = 'https://www.googleapis.com/youtube/v3/search';
            var searchText = encodeURI($('#txtSearch').val());

            

            $.ajax({
                url: url,
                dataType: 'json',
                type: 'GET',
                data: {
                    q: searchText,
                    part: 'snippet',
                    key: 'AIzaSyAoRJ_lJh1RmVR3nboH1GzHK8aKK-b1VvE',
                    maxResults: 25,
                    pageToken: pageToken.current
                }
            }).done(function(data) {
                var html = '';
                pageToken.nextPage = data.nextPageToken;
                pageToken.prevPage = data.prevPageToken;

                $.each(data['items'], function(index, value) {
                    //console.log(value);

                    html += '<div>';
                    html += '<div class="title">' + value.snippet.title + '</div>';
                    html += '<div class="url">';
                    html += '<a href="https://www.youtube.com/watch?v=' + value.id.videoId + '" target="_blank">'
                    html += value.id.videoId + '</a></div>';
                    html += '<div><img class="thumbnail" src="' + value.snippet.thumbnails.medium.url + '"></div>';
                    html += '</div>';
                })
                $('#output').html(html);

                $('.buttonOptions').hide();
            })
        }

    </script>
</body>

</html>